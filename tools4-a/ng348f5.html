<HTML>
<HEAD><TITLE>CA-Clipper Tools . Book 4-Appendices - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng343e6.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng2ac41.html">[^^Up^^]</A>
<A HREF="ng35151.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>NNETSALLST()</B>
 Determines the list of recoverable files (Netware 3.x only)
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>NNETSALLST([&lt;cPath&gt;]) --&gt; aFiles</B>

     <B>Netware: 2.2 and 3.11</B>

 <B>Argument</B>

     <B>&lt;cPath&gt;</B>  Designates the directory on a server volume in which the
     recoverable files are searched.  The default value designates the
     current directory on the current drive.

 <B>Returns</B>

     NNETPSQL() returns an array with subarray (two-dimensional array).  Each
     subarray contains information about a recoverable file.  For the
     subarray structure, see the following table:

     <B>Table 23.16:  NNETSALLST() Subarray Structure</B>
     ------------------------------------------------------------------------
     <B>Position     Metasymbol     CTNNET.CH      Definition</B>
     ------------------------------------------------------------------------
     1            cName          SAL_NAME       File name
     2            cSize          SAL_SIZE       File size
     3            dDate          SAL_DATE       Salvage date
     4            cTime          SAL_TIME       Salvage time
     5            cDeletor       SAL_DELETOR    Deletor
     ------------------------------------------------------------------------

     If an error occurs, the function returns an empty array.

 <B>Description</B>

     NOVELL NET SALVAGE LIST
     Files on a server volume that are deleted within DOS or within an
     application are logically marked for deletion and can be recovered with
     the Novell utility SALVAGE or the CA-Clipper Tools function
     NNETSALVAG().  NNETSALLST() returns a list of all files in the directory
     &lt;cPath&gt; that can be recovered.  This service is only available under
     Netware 3.x.

 <B>Examples</B>

     <B>.</B>  Determine the list of recoverable files in L:\DATA.  Display
        the name of the files and the name of the user that deleted these
        files:

        #include "ctnnet.ch"

        aFiles=NNETSALLST('L:\DATA')

        FOR i=1 TO LEN(aFiles)
           ? aFiles[i,SAL_NAME],aFiles[i,SAL_DELETOR]
        NEXT i

     <B>.</B>  Purge all recoverable files in L:\DATA:

        #include "ctnnet.ch"

        aFiles=NNETSALLST('L:\DATA')

        FOR i=1 TO LEN(aFiles)
           NNETPURGE('L:\DATA\'+aFiles[i,SAL_NAME])
        NEXT i
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng35151.html">NNETSALVAG()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
