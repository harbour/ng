<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng9bc36.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng89afa.html">[^^Up^^]</A>
<A HREF="ng9c6ce.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>RENAMEFILE()</B>
 Fault tolerant renaming of a file.
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>RENAMEFILE(&lt;cOldFileName&gt;, &lt;cNewFileName&gt;) --&gt; nErrorCode</B>

 <B>Arguments</B>

     <B>&lt;cOldFileName&gt;</B>   Designates the name and path of the existing file.

     <B>&lt;cNewFileName&gt;</B>   Designates the new name and path for the file.

 <B>Returns</B>

     The function returns a 0 when the file can be renamed; otherwise, it
     returns an error code.  The codes are defined below:

     <B>Table 7-19:  RENAMEFILE() Error Codes</B>
     ------------------------------------------------------------------------
     <B>Code    Definition</B>
     ------------------------------------------------------------------------
      0      No error found
     -2      File not found
     -3      Path not found
     -5      Access denied (e.g., in network)
     -17     Target file not on same network
     ------------------------------------------------------------------------

 <B>Description</B>

     Currently, you may not be able to rename a file on a network drive.
     Another user may currently have the file open.  RENAMEFILE() actually
     says "attempt a RENAME and, should the situation arise, return an error
     code".  This follows the basic programming philosophy:  never fall into
     an error trap when you can avoid it.

 <B>Notes</B>

     <B>.</B>  The &lt;cNewFileName&gt; must always contain the complete path for
        the designated file (see Examples).

     <B>.</B>  Wildcard characters cannot be used.

 <B>Examples</B>

     <B>.</B>  Rename a file from OLD to NEW:

        IF RENAMEFILE("OLD", "NEW") = 0
           ? "The file can be renamed!"
        ENDIF

     <B>.</B>  Use the path from the old file specification for the new name:

        cFSpecOld   := "C:\TEST\TEST.TXT"
        cFileName   := TOKEN(cFSpecOld, ":\")      // last token
        cFSpecNew   := BEFOREATNUM(cFileName, cFSpecOld) + "TEST.NEW"
        RENAMEFILE(cFSpecOld, cFSpecNew)

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng8ba28.html">DELETEFILE()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
