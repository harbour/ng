<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng9e9ad.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng89afa.html">[^^Up^^]</A>
<A HREF="ng9fb4d.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>STRFILE()</B>
 Writes a string to a file
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>STRFILE(&lt;cCharacterstring&gt;, &lt;cFile&gt;, [&lt;lOverwrite&gt;],</B>
     <B>   [&lt;nOffset&gt;], [&lt;lCutOff&gt;]) --&gt; nRecordedByte</B>

 <B>Arguments</B>

     <B>&lt;cCharacterstring&gt;</B>  Designates the character string to write to a
     file.

     <B>&lt;cFile&gt;</B>  Designates a file name.  Drive and path designations are
     permitted, but no wildcards.

     <B>&lt;lOverwrite&gt;</B>  If not designated or designated as .F., determines
     whether or not a new file is created.  When .T., it writes to an
     existing file.  The default is create new file (.F.).

     <B>&lt;nOffset&gt;</B>  Designates an offset within the file from which the
     &lt;cCharacterstring&gt; string is to be written.  The default is End of file.

     <B>&lt;lCutOff&gt;</B>  When this optional parameter is designated as .T., the
     function truncates the file if data written ends before the last file
     byte.  The default is no cut off (.F.).

 <B>Returns</B>

     STRFILE() returns the actual number of bytes written.

 <B>Description</B>

     This function provides another capability besides writing the contents
     of a string to a file.  In contrast to the CA-Clipper Fxxxx() functions,
     only one function call is necessary to write data to a file.  However,
     it can result in some speed disadvantages, since files acted on by
     STRFILE() cannot be held open.

     If the target file is unavailable, the STRFILE() function always creates
     it.

 <B>Notes</B>

     <B>.</B>  The attribute to create a new file, can be designated with the
        SETFCREATE() function.

     <B>.</B>  As recommended with the share mode, reads and writes from
        other network programs should be locked out with SETSHARE() for this
        period of time.

     <B>.</B>  This function acknowledges the setting for CSETSAFETY().

 <B>Examples</B>

     <B>.</B>  Add to the end of a file:

        ? STRFILE("ABCDEFGH", "TEST.TXT", .T.)             // Result: 8

     <B>.</B>  A file with drive and path designations, result: 10:

        ? STRFILE("0123456789", "C:\TEXT\TEST.TXT", .T.)

     <B>.</B>  Data in an existing file is overwritten from position 20 with
        a designated string:

        ? STRFILE("NANTUCKET", "TEST.TXT", .T., 20)        // Result: 9

     <B>.</B>  A 5-character string is written starting at position 10 in an
        existing file 20-characters long.  Since the final parameter is
        specified as .T. once, and specified as .F. once, you see different
        results:

        ? STRFILE(REPLICATE("X", 20), "TEST.TXT")
        ? STRFILE("AAAAA", "TEST.TXT", .T., 10, .F  // "XXXXXXXXXXAAAAAXXXXX"
        ? STRFILE("AAAAA", "TEST.TXT", .T., 10, .T  // "XXXXXXXXXXAAAAA"

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng99700.html">FILESTR()</A>
<A HREF="ng9e9ad.html">SETSHARE()</A>
<A HREF="ng9dd66.html">SETFCREATE()</A>
<A HREF="ngb4677.html">CSETSAFETY()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
