<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng954bb.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng89afa.html">[^^Up^^]</A>
<A HREF="ng96256.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>FILECOPY()</B>
 Copies files normally or in backup mode
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>FILECOPY(&lt;cSourceFile&gt;, &lt;cTargetFile&gt;, [&lt;lMode&gt;])</B>
     <B>   --&gt; nCopyByte</B>

 <B>Arguments</B>

     <B>&lt;cSourceFile&gt;</B>  Designates the source file.  Drive and path
     designations are permitted, but not wildcards.

     <B>&lt;cTargetFile&gt;</B>  Designates the target file.  Drive and path
     designations are permitted, but not wildcards.

     <B>&lt;lMode&gt;</B>  Designates the backup mode on when designated as .T.  The
     default is no backup mode (.F.).

 <B>Returns</B>

     FILECOPY() returns the number of bytes copied.

 <B>Description</B>

     This function has additional uses besides allowing you to quickly copy
     files.  When you use the optional &lt;lMode&gt; parameter, a unique backup
     mode is switched on.  This allows files that are larger than the target
     disks to be copied.  This function writes the maximum possible number of
     bytes to a disk.  FILECOPEN() allows you to determine whether all data
     from the source file has been copied.  It then continues with the next
     disk.  The target disks should contain unique labels and be saved to a
     catalog.

 <B>Notes</B>

     <B>.</B>  The attribute to be used when newly creating a file can be
        specified with SETCREATE().

     <B>.</B>  As a minimum, the share mode recommends that you do not write
        other program source and target files.

     <B>.</B>  This function acknowledges the CSETSAFETY() setting, and as a
        result, cannot overwrite a target file.

 <B>Examples</B>

     <B>.</B>  Show a simple copy:

        ? FILECOPY("A:\TEXT.TXT", "C:\TEST.TXT")      // Bytes copied

     <B>.</B>  A back up using FILECOPY():

        nCounter  :=  1                               // "BIG.001" etc.
        cTargetFile  := "BIG" + NTOC(nCounter, 10, 3, "0")
        FILECOPY("BIG.DBF", "A:\" + cTargetFile, .T.)
                                                      // Back up mode
        DO WHILE FILECOPEN()
           DO NEXTDISK                                // Request disk change
           nCounter     := nCounter + 1
           cTargetFile  := "BIG" + NTOC(nCounter, 10, 3, "0")
           FILECCONT(cTargetFile)                     // Next disk - new name
        ENDDO
        RETURN

        PROCEDURE NEXTDISK
           ? "Please insert new diskette in Drive A:!"
           WAIT
           RETURN

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng943d6.html">FILECCONT()</A>
<A HREF="ng954bb.html">FILECOPEN()</A>
<A HREF="ng93f1a.html">FILECCLOSE()</A>
<A HREF="ng92bea.html">FILEAPPEND()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
