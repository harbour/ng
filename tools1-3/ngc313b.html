<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ngc2cb1.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngbe570.html">[^^Up^^]</A>
<A HREF="ngc3ce2.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>KEYSEC()</B>
 Triggers a key trap after a time delay
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>KEYSEC([&lt;nKeyValue&gt;,&lt;nTime&gt;, [&lt;nCounter&gt;],</B>
     <B>   [&lt;lMode&gt;]]) --&gt; lActivated</B>

 <B>Arguments</B>

     <B>&lt;nKeyValue&gt; </B> Designates the key code to place in the keyboard
     buffer.

     <B>&lt;nTime&gt;</B>  Designates the time, in seconds, after which the character
     is placed in the buffer.  Negative values correspond to multiples of
     1/18.2 seconds.

     <B>&lt;nCounter&gt;</B>  Designates the number of times the function occurs
     before it uninstalls itself.  A value of -1 indicates that KEYSEC() will
     continue until it is specifically uninstalled.  The default value is
     "Uninstall after the first call" (1).

     <B>&lt;lMode&gt;</B>  Designates whether the internal time counter restarts at
     the beginning (.T.) or not (.F.), after you press a desired key.  The
     default value is "No new start with key stroke" (.F.).

     ()  When called without parameters, the function is completely
     uninstalled.

 <B>Returns</B>

     KEYSEC() returns a value of .T. when installed correctly, so that the
     desired character will be placed in the keyboard buffer after the
     specified time.

 <B>Description</B>

     This function is useful in DEMO programs.  If used in conjunction with
     KEYSEND(), you can simulate any keyboard input with time delays.

     Use KEYSEC() in conjunction with CA-Clipper's SET KEY..TO, for key traps
     (just like KEYTIME()).  For example, this makes it possible to
     automatically write data still in the DOS buffer, to the hard drive at
     specific intervals during a GET..READ.

     As soon as the character is placed in the keyboard buffer &lt;nCounter&gt;
     times, KEYSEC() uninstalls itself.

     If the &lt;lMode&gt; parameter is specified as .T., the elapsed time counter
     is reset when you press any key.

     If you want to specifically uninstall the function from the program,
     call it without parameters.

 <B>Notes</B>

     <B>Warning!</B>  Always uninstall the function before you leave the program
     or use the CTUS.LIB Extended Drivers found in CA-Clipper Tools.  The
     function changes interrupt vectors, and if the previous status is not
     restored before you exit the program, the system will eventually crash.

     <B>.</B>  Only one time delay can be active.  A new KEYSEC() deactivates
        the previous one.

     <B>.</B>  You can use any symbols defined in the CA-Clipper file
        INKEY.CH.  You can set any other keys described in the CA-Clipper
        Tools header file CTSCAN.CH.

 <B>Examples</B>

     <B>.</B>  Place CHR(7) in the keyboard buffer three times, every 5
        seconds:

        ? KEYSEC(7, 5, 3)             // (.T.)

     <B>.</B>  Place CHR(255) in the keyboard buffer every 60 seconds until
        an uninstall occurs:

        ? KEYSEC(255, 60, -1)         // (.T.)

     <B>.</B>  As soon as a key is pressed, the internal counter restarts
        from the beginning:

        ? KEYSEC(13, 60, -1, .T.)     // (.T.)

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ngc3ce2.html">KEYTIME()</A>
<A HREF="ngb6d0b.html">LASTKLINE()</A>
<A HREF="ngb6953.html">LASTKFUNC()</A>
<A HREF="ngb71c8.html">LASTKPROC()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
