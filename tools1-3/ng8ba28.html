<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng8a6ec.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng89afa.html">[^^Up^^]</A>
<A HREF="ng8c0db.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>DELETEFILE()</B>
 Deletes an error-tolerant file
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>DELETEFILE(&lt;cFileName&gt;) --&gt; nErrorCode</B>

 <B>Argument</B>

     <B>&lt;cFileName&gt;</B>  Designates which file name to delete.

 <B>Returns</B>

     DELETEFILE() returns a code that signifies its completion status:

     <B>Table 7-1:  DELETEFILE() Error Codes</B>
     ------------------------------------------------------------------------
     <B>Code    Symb. constants     Definition</B>
     ------------------------------------------------------------------------
      0      NO_DISK_ERR         No error occurs
     -2      ER_FILE_NOT_FOUND   File not found
     -3      ER_PATH_NOT_FOUND   Path not found
     -5      ER_ACCESS_DENIED    Access denied (e.g., file is read-only)
     ------------------------------------------------------------------------

 <B>Description</B>

     In contrast to FILEDELETE(), which permits you to specify file groups
     with wildcards, DELETEFILE() only accepts specific file names.  However,
     the function avoids all DOS error messages and returns an error code
     directly to the calling program.  This makes error-tolerant erasures in
     networks possible (see Examples).

 <B>Note</B>

     <B>.</B>  You can use a drive designator and path name, but no
        wildcards.

 <B>Examples</B>

     <B>.</B>  How NOT to delete a file in a network environment:

        IF FILE ("TEST.DBF")
           * Is it actually possible to delete the file?
           DELETE FILE TEST.DBF
        ENDIF

     <B>.</B>  This is a better way:

        nStatus  :=  DELETEFILE("TEST.DBF")
        IF nStatus == 0
           ? "File deleted."
        ELSE
           IF nStatus == -5
              ? "ACCESS DENIED!"
              ? "File in use elsewhere!"
           ENDIF
        ENDIF

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng96c32.html">FILEDELETE()</A>
<A HREF="ng9bf5b.html">RENAMEFILE()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
