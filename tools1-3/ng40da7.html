<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng40378.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng3b7f6.html">[^^Up^^]</A>
<A HREF="ng41b76.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>ATREPL()</B>
 Searches for a sequence within a string and replaces it
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>ATREPL(&lt;cSearchFor&gt;,&lt;cString&gt;,&lt;cReplace&gt;,</B>
     <B>   [&lt;nCounter&gt;],[&lt;lMode&gt;]) --&gt; cString</B>

 <B>Arguments</B>

     <B>&lt;cSearchFor&gt;</B>  Designates the expression for which the function
     searches.

     <B>&lt;cString&gt;</B>  [@]  Designates the character string that is searched.

     <B>&lt;cReplace&gt;</B>  Designates the character string that is exchanged for
     the sequence in &lt;cString&gt;.

     <B>&lt;nCounter&gt;</B>  Designates which or how many occurrences of &lt;cSearchFor&gt;
     within &lt;cString&gt; are replaced by &lt;cReplace&gt;.  The default value is for
     the last occurrence of the search expression.

     <B>&lt;lMode&gt;</B>  Designates if only the nth (&lt;nCounter&gt;) sequence is
     replaced (.T.), or if all sequences up to the nth (&lt;nCounter&gt;) are
     replaced (.F.).  The default value (.F.) designates that all sequences
     are replaced.

 <B>Returns</B>

     The function returns a character string in which one or many of the
     &lt;cSearchFor&gt; sequences have been replaced by &lt;cReplace&gt;.

 <B>Description</B>

     ATREPL() allows you to replace one or more sequences within &lt;cString&gt;.
     &lt;cReplace&gt; can be shorter or longer than &lt;cSearchFor&gt;.

     &lt;nCounter&gt; specifies that the function searches for the nth occurrence
     of the sequence.  If no value is specified, then the last occurrence is
     used.  All occurrences of &lt;cSearchFor&gt;, up to and including the one
     sought, are replaced unless &lt;nCounter&gt; is assigned a value greater than
     0 and &lt;lMode&gt; is designated .T..

     The CSETATMUPA() setting is only checked when the length of &lt;cReplace&gt;
     is shorter than or equal to that of &lt;cSearchFor&gt;, yielding different
     results.  Beginning on the left, the character string is searched for
     each occurrence of the &lt;cSearchFor&gt; sequence.  If CSETATMUPA() is off
     (.F.), then the search continues after the last character of the
     replaced sequence.  However, if CSETATMUPA() is on, the search always
     continues from the first character of the replaced sequence.

 <B>Notes</B>

     <B>.</B>  By implementing SETATLIKE() you can use wildcard characters
        within the search sequence.

     <B>.</B>  &lt;cString&gt; can be passed by reference.  If this is the case,
        then both &lt;cSearchFor&gt; and &lt;cReplace&gt; must be the same length.

     <B>.</B>  If &lt;cSearchFor&gt; and &lt;cReplace&gt; are identical, the function
        terminates immediately.  Such an exchange makes no sense, and if
        CSETATMUPA() is (.T.), the exchange results in an endless loop.

 <B>Examples</B>

     <B>.</B>  Exchange all "123" with "ab":

        ? ATREPL("123", "123_123_123", "ab")             // "ab_ab_ab"

     <B>.</B>  Replace "789" with a longer string "abcd" (ignore multi-pass):

        ? ATREPL("789", "789_789", "abcd")               // "abcd_abcd"

     <B>.</B>  Exchange all "123" with "ab", up to and including the second
        occurrence:

        ? ATREPL("123", "123_123_123", "ab", 2)          // "ab_ab_123"

     <B>.</B>  Exchange only the second occurrence of "123" with "ab":

        ? ATREPL("123", "123_123_123", "ab", 2, .T.)     // "123_ab_123"

     <B>.</B>  Exchange all "aa" for "a" and the change the influence of
        CSETATMUPA():

        CSETATMUPA(.F.)
        ? ATREPL("aa", "aaaa", "a")                      // "aa"

        CSETATMUPA(.T.)
        ? ATREPL("aa", "aaaa", "a")                      // "a"

     <B>.</B>  Exchange "abc" with "ab", with and without multi-pass:

        CSETATMUPA(.F.)
        ? ATREPL("abc", "123abcc456", "ab")              // "123abc456"

        CSETATMUPA(.T.)
        ? ATREPL("abc", "123abcc456", "ab")              // "123ab456"

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng4d968.html">CSETATMUPA()</A>
<A HREF="ng5a43c.html">SETATLIKE()</A>
<A HREF="ng3d0d0.html">Introduction</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
