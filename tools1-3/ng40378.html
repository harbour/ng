<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng3f806.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng3b7f6.html">[^^Up^^]</A>
<A HREF="ng40da7.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>ATNUM()</B>
 Determines the starting position of a sequence within a string
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>ATNUM(&lt;cSearchFor&gt;,&lt;cString&gt;,[&lt;nCounter&gt;],</B>
     <B>   [&lt;nIgnore&gt;]) --&gt; nPosition</B>

 <B>Arguments</B>

     <B>&lt;cSearchFor&gt;</B>  Designates the expression for which the function
     searches.

     <B>&lt;cString&gt;</B>  Designates the character string to search.

     <B>&lt;nCounter&gt;</B>  Designates which occurrence of &lt;cSearchFor&gt; within
     &lt;cString&gt; is determined.  The default value is for the last occurrence
     of the search expression.

     <B>&lt;nIgnore&gt;</B>  Designates the number of characters that should be
     excluded from the search.  The default value is none (0).

 <B>Returns</B>

     The function returns the position where &lt;cSearchFor&gt; begins.  If no
     corresponding position can be determined, the function returns 0.

 <B>Description</B>

     ATNUM() determines the initial position of the nth (&lt;nCounter&gt;)
     occurrence of &lt;cSearchFor&gt; within the &lt;cString&gt;.  Additionally, the
     function takes into account the CSETATMUPA() setting, which causes
     differing results.

     ATNUM() searches from the left in order to determine the nth
     (&lt;nCounter&gt;) occurrence of the &lt;cSearchFor&gt;.  If CSETATMUPA() is off,
     the search continues after the last character of the sequence most
     recently located.  However, if the CSETATMUPA() is on, the search always
     continues after the first character in the most recently located
     sequence.

     If the &lt;nIgnore&gt; parameter is not specified, the function initiates the
     search with the first character of &lt;cString&gt;.  If the &lt;nIgnore&gt;
     parameter is specified, &lt;nIgnore&gt; characters are ignored from the start
     of the string and are excluded from the search.

 <B>Notes</B>

     <B>.</B>  If no value is specified for &lt;nCounter&gt;, the function
        determines the last occurrence of the &lt;cSearchFor&gt; sequence.

     <B>.</B>  When you implement SETATLIKE(), wildcard characters can be
        used within the search expression.

 <B>Examples</B>

     <B>.</B>  Search for the last occurrence:

        ? ATNUM("bc", "abcdeabc")               // Result: 7

     <B>.</B>  Search for the first occurrence:

        ? ATNUM("bc", "abcdeabc", 1)            // Result: 2

     <B>.</B>  Search for the first occurrence, excluding the first three
        characters:

        ? ATNUM("bc", "abcdeabc", 1, 3)         // Result: 7

     <B>.</B>  Determine the impact of CSETATMUPA() on a search for the last
        occurrence of "aa" in "aaa":

        CSETATMUPA(.F.)                         // Off
        ? ATNUM("aa", "aaa")                    // Result: 1

        CSETATMUPA(.T.)                         // On
        ? ATNUM("aa", "aaa")                    // Result: 2

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng4d968.html">CSETATMUPA()</A>
<A HREF="ng5a43c.html">SETATLIKE()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
