<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng121d0.html">[&lt;&lt;Previous Entry]</A>
<A HREF="nge404.html">[^^Up^^]</A>
<A HREF="ng12f83.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>DSETWINDOW()</B>
 Reroutes external functions and programs to a window
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>DSETWINDOW([&lt;lNewDisplayMode&gt;]) --&gt; lOldDisplayMode</B>

 <B>Argument</B>

     <B>&lt;lNewDisplayMode&gt;</B>  Designates whether the screen output from
     external programs or other language UDF's displays in the current
     window.

 <B>Returns</B>

     When called without a parameter, the function returns the current
     setting for DSETWINDOW().  If a parameter is passed, it returns the
     previous setting.

 <B>Description</B>

     DSETWINDOW() allows you to determine if only CA-Clipper screen outputs
     should appear in a window, or if all outputs (all external modules and
     programs, including DOS) should appear.  If you would like to implement
     a subroutine for screen handling with CA-Clipper Tools window functions,
     you can use this switch to turn off these functions for a short time.

     <B>Important!</B>  Before you call external programs using RUN, you should
     set DSETWINDOW() to .F.; if you do not, some programs will not run
     correctly.

 <B>Notes</B>

     <B>Important!</B>  The standard setting for DSETWINDOW() is on.  This means
     that all program output, not written directly into the screen memory,
     displays in the currently active window.

     <B>.</B>  CA-Clipper screen output is always written in a window if one
        is open and active.  Only screen output from external routines (like
        Assembler or C UDF's, or external programs called using RUN) can be
        affected.  CA-Clipper Tools functions are also viewed as foreign or
        external.

     <B>.</B>  If you call DSETWINDOW() with .T., a change in cursor position
        in an external module or program also affects the cursor position in
        CA-Clipper.  If you do not want to change the cursor position in
        CA-Clipper, then set DSETWINDOW() to .F. so that the CA-Clipper
        cursor position remains unchanged.  If you still want to pass the
        cursor position to CA-Clipper, then use the SETRC() function without
        parameters.

     <B>.</B>  Some CA-Clipper Tools functions ignore this switch because
        they work directly with the physical screen memory.

     <B>.</B>  CA-Clipper Tools has a public variable available for your own
        Assembler or C routines to affect the DSETWINDOW() function.  It can
        be addressed as follows:

        EXTR _WINDOW:WORD
        MOV  _WINDOW, 0               // Window functions OFF, all
                                      // other values switched ON!

     <B>.</B>  If the switch is set to on, then interrupt 16 (10h, video) and
        function 19 (13h, write string), normally only available on AT's,
        become available on PC XT's.

 <B>Examples</B>

     <B>.</B>  Do not reroute other program output to the selected window:

        DSETWINDOW(.F.)

     <B>.</B>  Do a test to see if ANSI.SYS has been linked in to CONFIG.SYS:

        lVar  :=  DSETWINDOW(.F.)
        ? ISANSI()
        DSETWINDOW(lVar)              // Reset to old status

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng81141.html">SCREENFILE()</A>
<A HREF="ng764c0.html">FILESCREEN()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
