<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ngbfbcc.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngbe570.html">[^^Up^^]</A>
<A HREF="ngc0caf.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>DATATYPE()*</B>
 Determines the data type of a variable or UDF
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>DATATYPE(&lt;expValue&gt;) --&gt; nDataType</B>

     <B>*  This is retained in CA-Clipper for compatibility purposes.  Use the</B>
     <B>   CA-Clipper VALTYPE() function to develop future applications.</B>

 <B>Argument</B>

     <B>&lt;expValue&gt;</B>  Designates any valid CA-Clipper expression.

 <B>Returns</B>

     DATATYPE() returns a value that corresponds to the data type in
     &lt;expValue&gt;.

 <B>Description</B>

     DATATYPE() is similar to the CA-Clipper TYPE() function, but returns
     more extensive information in numeric value form.  The bits in the
     result correspond to specific data types.  Two bits can be set at the
     same time.  It is easy to recognize specific data types with the ISBIT()
     function.  The following codes apply:

     <B>Table 13-2: Data Type Coding</B>
     ------------------------------------------------------------------------
     <B>Value   Symb. Const.   Data Type</B>
     ------------------------------------------------------------------------
      0      TYPE_UNDEF     Undefined
      1      TYPE_STR       Character string
      2      TYPE_NUM       Numeric
      4      TYPE_LOG       Logical
      8      TYPE_DATE      Date
     16      TYPE_ALIAS     Alias
     64      TYPE_MEMO      Memo field
     128     TYPE_WORD      Word
     512     TYPE_ARRAY     Array
     4096    TYPE_BLOCK     Code block
     ------------------------------------------------------------------------

     In addition, DATATYPE() returns the respective data type for a
     CA-Clipper Tools function or one of your own UDF's.  This is impossible
     with TYPE().

 <B>Notes</B>

     <B>.</B>  An invalid &lt;expValue&gt; output results in a runtime error.

     <B>.</B>  The function cannot determine if a parameter has passed to a
        function by reference (32 + type), because this information is no
        longer available in CA-Clipper.

 <B>Example</B>

     Return values of DATATYPES() used for different data types:

     ? DATATYPE()                 //    0, undefined
     ? DATATYPE("XXX")            //    1, string
     ? DATATYPE(123)              //    2, numeric
     ? DATATYPE(DOY())            //    2, numeric result
     ? DATATYPE(.T.)              //    4, logical
     ? DATATYPE(3 &gt; 2)            //    4, logical expression
     ? DATATYPE(EOF())            //    4, logical result
     ? DATATYPE(DATE())           //    8, date
     ? DATATYPE(memofld)          //    1, memo field
     ? DATATYPE(@crlf)            //   33, reference to string
     ? DATATYPE(@array)           //  544, reference to array
     ? DATATYPE(array[1])         //    2, numeric element
     ? DATATYPE(array[2])         //    1, string element
     ? DATATYPE(myfunc())         //       type for your own UDF

</PRE>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
