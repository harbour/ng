<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng3157e.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng26a91.html">[^^Up^^]</A>
<A HREF="ng3261e.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>COM_NUM()</B>
 Gives the number of the highest available serial interface port
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>COM_NUM() --&gt; nMaxCom</B>

 <B>Returns</B>

     COM_NUM() returns the number of the highest available serial interface
     port.

 <B>Description</B>

     This function returns the number of the serial interface port available.
     This is not to say that a return value of 3 necessarily means that ports
     1 through 3 are available; for example, COM2 could be missing.  Whether
     or not a serial port can actually be used can be tested using the
     COM_OPEN() or COM_INIT() functions.

     Normally the addresses described in the Introduction to this chapter are
     scanned for available ports.  Scanning can happen over alternate
     addresses selected through COM_SETIO().

     <B>Important!</B>  Four I/O addresses are assigned to ports COM1 - COM4,
     internal to the port functions.  The COM_NUM() function goes through
     these four addresses and tests to see if a port is available there.
     This can lead to problems if some other hardware is installed in one of
     the address areas.  For example, problems like this have been noted in
     conjunction with ArcNet network cards, which conflict in the address
     area with COM4.  The critical address areas are listed in the table
     below.

     <B>Table 3-6: I/O Addresses for COM1-COM4</B>
     ------------------------------------------------------------------------
     <B>Port    I/O Addresses</B>
     ------------------------------------------------------------------------
     COM1    03F8h - 03FFh
     COM2    02F8h - 02FFh
     COM3    03E8h - 03EFh
     COM4    02E8h - 02EFh
     ------------------------------------------------------------------------

     If any kind of hardware is found within this I/O address area, then the
     conflicting COM port can be masked.  Additionally, using COM_SETIO()
     (&lt;nComPort&gt;, 0) the accompanying base address within the internal table
     is deleted.  You can only mask the conflicting port when COM_NUM() has
     not previously been called in the program.  If COM_NUM() has been called
     in the program, the interface is marked "in use".

 <B>Examples</B>

     <B>.</B>  Determine the number of ports at the standard addresses:

        ? COM_NUM()                 // e.g. 4

     <B>.</B>  Determine the number of ports at unusual addresses:

        COM_SETIO(3, "110")         // COM3, 110h
        COM_SETIO(4, "120")         // COM4, 120h
        ? COM_NUM()

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng35e81.html">COM_SETIO()</A>
<A HREF="ng3261e.html">COM_OPEN()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
