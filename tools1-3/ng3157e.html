<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng30f73.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng26a91.html">[^^Up^^]</A>
<A HREF="ng31c78.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>COM_MSR()</B>
 Reads the Modem Status Register (MSR)
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>COM_MSR(&lt;nComPort&gt;) --&gt; nMSR</B>

 <B>Argument</B>

     <B>&lt;nComPort&gt;</B>  Designates the port (1 to 4) for which the Modem Status
     Register is read.  COM1(1) to COM4(4) are possible.

 <B>Returns</B>

     COM_MSR() returns a value between 0 and 255 that corresponds to the
     contents of the MSR.

 <B>Description</B>

     Not all the values for this status register can be determined from
     separate functions.  For example, if you need Delta status information,
     you can use this function and test the corresponding bit.  The
     individual bits are defined as follows:

     <B>Table 3-5: MC-Register Coding</B>
     ------------------------------------------------------------------------
     <B>Bit     Symb. Const.   Definition</B>
     ------------------------------------------------------------------------
     0       MSR_ERROR      Parameter error
     1       MSR_DELTA_CTS  DELTA ready to send (DCTS)
     2       MSR_DELTA_DSR  DELTA data terminal ready (DDSR)
     4       MSR_TERI       Trailing edge RING (TERI)
     8       MSR_DELTA_DCD  DELTA data carrier detected (DDCD)
     16      MSR_CTS        Clear to send (CTS)
     32      MSR_DSR        Data terminal ready (DSR)
     64      MSR_RI         RING indicator (RI)
     128     MSR_DCD        Data carrier detected (DCD)
     ------------------------------------------------------------------------

 <B>Notes</B>

     <B>.</B>  The simultaneous testing of multiple bits in the MSR is fairly
        simple when using a logical AND operation.

     <B>.</B>  All delta bits in this register are reset using a read
        procedure.

 <B>Example</B>

     nStatus  :=  COM_MSR(1)

     IF ISBIT(nStatus, 5)            // CTS (Bit-5) active?
        . . .
     ENDIF

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng2b28d.html">COM_CTS()</A>
<A HREF="ng2bfeb.html">COM_DSR()</A>
<A HREF="ng343d8.html">COM_RING()</A>
<A HREF="ng2b60a.html">COM_DCD()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
