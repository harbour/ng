<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng80cbd.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng6e113.html">[^^Up^^]</A>
<A HREF="ng81ee2.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>SCREENFILE()</B>
 Writes screen content to a file
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>SCREENFILE(&lt;cFileName&gt;, [&lt;lOverwrite&gt;],</B>
     <B>   [&lt;nOffset&gt;]), [&lt;lTrim&gt;] --&gt; nBytesWritten</B>

 <B>Arguments</B>

     <B>&lt;cFileName&gt;</B>  Designates the name and path of the screen file.

     <B>&lt;lOverwrite&gt;</B>  Designates whether you are to append to an existing
     file (.T.), or to overwrite it (.F.).  The default is overwrite (.F.).

     <B>&lt;nOffset&gt;</B>  Designates the file offset from which you append, when
     &lt;lOverwrite&gt; is designated as .T..  The default is the end of file.

     <B>&lt;lTrim&gt;</B>  If this optional parameter is designated as .T., the
     function trims the file when the written data ends and before the last
     byte of the file.  The default is do not trim (.F.).

 <B>Returns</B>

     SCREENFILE() returns the number of bytes written to the screen file.

 <B>Description</B>

     SCREENFILE() saves the contents of a screen to a file.  Since the
     CA-Clipper SAVE SCREEN and RESTORE SCREEN also work with windows when
     you use the CA-Clipper Tools Extended Drivers, use SCREENFILE() to save
     the entire screen.  The number of characters you can write this way
     depends on the respective screen mode.  For example, in a 50-line VGA
     mode you can write 8000 instead of 4000 characters.  Use SCREENSIZE() to
     determine the exact screen size at any given time.  You can only use the
     &lt;nOffset&gt; parameter when you specify &lt;lOverwrite&gt; at the same time.
     &lt;nOffset&gt; then specifies from which position in the screen file the new
     screen data is to be written.  If the &lt;nOffset&gt; position lies before the
     end of the file, the file is overwritten.  If it exceeds the end of the
     file, the data is appended.  The default value for &lt;nOffset&gt; is
     selected, so if you omit it and designate &lt;lOverwrite&gt; as .T., the file
     is appended.  This behavior allows you to save the contents of several
     screens to a file.

     It is possible that a screen could be written to an already existing
     file, and that everything beyond this screen is trimmed off.  The
     &lt;lTrim&gt; logical parameter must be designated as .T..

 <B>Notes</B>

     <B>.</B>  If SCREENFILE() creates a new file, use SETFCREATE() to create
        an alternate attribute for this new file .

     <B>.</B>  If you turn on the CA-Clipper Tools CSETSAFETY() internal
        switch, the target file is not overwritten, even if the &lt;lOverwrite&gt;
        parameter is designated as .F..

     <B>.</B>  Wildcards within the file name are not permitted here.

 <B>Examples</B>

     <B>.</B>  An existing file is overwritten:

        SCREENFILE("screen.tst")                        // Result:  4000&gt;
        SCREENFILE("\screen.tst")                       // Result:  4000&gt;
        SCREENFILE("a:\screen.tst")                     // Result:  4000

     <B>.</B>   On a VGA card in 50-line mode:

        SCREENFILE("screen.tst")                        // Result:  8000

     <B>.</B>  The file is appended:

        SCREENFILE("screen.tst", .T. )                  // Result:  4000

     <B>.</B>  Insert a screen from an offset of 4000 ( i.e., after the first
        screen):

        SCREENFILE("screen.tst", .T., 4000)             // Result:  4000

     <B>.</B>  Insert a screen after the third screen:

        SCREENFILE("screen.tst", .T., 12000)            // Result:  4000

     <B>.</B>  Overwrite an existing file in the fourth screen and trim off
        the rest of the file:

        SCREENFILE("screen.tst", .T., 12000, .T.)       // Result:  4000

     <B>.</B>  Wildcards not permitted:

        SCREENFILE("screen.*")                          // Result:  0

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng764c0.html">FILESCREEN()</A>
<A HREF="ng833e7.html">SCREENSIZE()</A>
<A HREF="ngb4677.html">CSETSAFETY()</A>
<A HREF="ng9dd66.html">SETFCREATE()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
