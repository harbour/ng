<HTML>
<HEAD><TITLE>CA-Clipper Tools . Books 1-3 - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ngc313b.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngbe570.html">[^^Up^^]</A>
<A HREF="ngc47fb.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>KEYTIME()</B>
 Triggers a key trap at a specific clock time
------------------------------------------------------------------------------
 <B>Syntax</B>

     <B>KEYTIME([&lt;nKeyValue&gt;,&lt;cClocktime&gt;]) --&gt; lActivated</B>

 <B>Arguments</B>

     <B>&lt;nKeyValue&gt;</B>  Designates the character to place in the keyboard
     buffer.

     <B>&lt;cClocktime&gt;</B>  Designates the specified time to place the character
     in the keyboard buffer.

     ()  When called without parameters, the function completely uninstalls.

 <B>Returns</B>

     KEYTIME() returns a .T. to indicate the specified character was placed
     in the keyboard buffer at the desired time.

 <B>Description</B>

     <B>Warning!</B>  Use on AT-class systems only!

     KEYTIME() executes a specific program at an indicated time.  To do this,
     the function places the desired key code in the keyboard buffer at the
     selected clock time.  If a procedure is established with
     SET KEY..TO, CA-Clipper calls the procedure if, or when, you are in a
     wait state.  This allows you to perform specific tasks at a particular
     time of day such as file backups.

     There is also a special variant over and above an exact time
     designation.  You can specify "99" for hours, minutes, or seconds, which
     modifies the interpretation of this portion of the time designation.  A
     time string of "10:99:00" instructs the function to trigger a key trap
     every minute between 10:00 and 10:59.

     If you want to specifically uninstall the function from the program,
     call it without specifying parameters.

 <B>Notes</B>

     <B>Warning!</B>  Always uninstall the function before you leave the program
     or use the CTUS.LIB Extended Drivers found in CA-Clipper Tools.  This
     function changes the interrupt vectors, and if the previous status is
     not restored before you leave the program, a system crash will
     eventually occur.

     <B>.</B>  Only one time monitor can be active at any given time.  A
        subsequent call to KEYTIME() deactivates the previous one.

     <B>.</B>  You can use any symbols defined in the CA-Clipper file
        INKEY.CH.   You can set any other keys described in the CA-Clipper
        Tools header file CTSCAN.CH.

 <B>Examples</B>

     <B>.</B>  Place key code 7 in the keyboard buffer at 12:30:

        ? KEYTIME(7, "12:30:00")      // .T.

     <B>.</B>  Place key code 255 in the keyboard buffer at 2:00 PM:

        ? KEYTIME(255, "2")           // .T.

     <B>.</B>  Place key code 7 in the keyboard buffer at midnight:

        ? KEYTIME(7, "00:00:00")      // .T.

     <B>.</B>  Set a key trap every second, starting at 11:59 PM:

        ? KEYTIME(7, "11:59:99")      // .T.

     <B>.</B>  Set a key trap every full hour:

        ? KEYTIME(7, "99:00:00")      // .T.

     <B>.</B>  Call with an invalid time:

        ? KEYTIME(7, "25:30:00")      // .F.

     <B>.</B>  Uninstall KEYTIME():

        ? KEYTIME()                   // .F.

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ngc313b.html">KEYSEC()</A>
<A HREF="ngb6d0b.html">LASTKLINE()</A>
<A HREF="ngb6953.html">LASTKFUNC()</A>
<A HREF="ngb71c8.html">LASTKPROC()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
