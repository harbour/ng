<HTML>
<HEAD><TITLE>ClipMore 3.0 Reference Manual - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng2f7b.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngeba.html">[^^Up^^]</A>
<A HREF="ng3fec.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
<B>cmFilter()</B>            Rapidly isolate records meeting a condition
------------------------------------------------------------------------------

<B>Synopsis</B>

    cmFilter([cCondition]) -&gt; NIL

<B>Arguments</B>

    cCondition is a character string specifying the condition which records
    need to meet.

    If no arguments are given, calling cmFilter() is equivalent to calling
    cmClrFilter().

<B>Returns</B>

    NIL.

<B>Description</B>

    The cmFilter() function is similar to a SET FILTER TO command:  it
    isolates the records which meet a condition, and makes all non-matching
    records "invisible."  If cmFilter() is invoked with no parameters, it is
    equivalent to invoking cmClrFilter().

    cmFilter() analyzes the condition and rapidly builds a bit-map of
    all records which meet the condition using available indexes.

    This bit-map is then used so that only records which actually meet the
    filter condition are actually accessed.

    It then does a SET FILTER TO of the given condition.

    The SET FILTER TO is done because in a multi-user environment, if the
    database is not explicitly locked by your application, the records can
    change.  The SET FILTER TO insures that if a record which originally met
    the condition changes and no longer meets the condition, it becomes
    invisible.

    For the best possible performance you should have indexes created on all
    expressions referenced in the condition.

<B>Example</B>

    * Use demo with the indexes needed for full optimization
    use demo index last, salary, age
    * Get only the records which meet this condition
<B>    cmFilter("salary &gt;= 900000 .and. age &lt; 30")</B>
    list last, age, salary
    * Clean up the side-effects generated by cmFilter()
    cmClrFilter()

<B>Example</B>

    use demo index last, age, salary, lastcall
    * Get the condition from the user
    clear
    cond = space(65)
    @ 0,0 say "Condition: " get cond
    read
    * Just pass the character string containing the condition
<B>    cmFilter(cond)</B>
    go top
    * Let user browse the result
    dbedit()
    * Clean up
    cmClrFilter()

<B>Example</B>

        //  Give user a constrained query
    local nLowAge := 0
    local nHighAge := 99
    local cState := space(2)

        //  Get the condition
    cls
    @ 0, 0 say " Low Age: " get nLowAge
    @ 1, 0 say "High Age: " get nHighAge
    @ 2, 0 say "   State: " get cState
    read

        //  Now get the records, let user browse, and clean up
    cmFilter("      age &gt;= " + cm2Str(nLowAge) + ;
             ".and. age &lt;= " + cm2Str(nHighAge) + ;
             ".and. state= " + cm2Str(cState))
    dbedit()
    cmClrFilter()

<B>See Also</B>

    cmClrFilter(), cmFiltCount(), cmSetLinear()

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng1ff6.html">cmClrFilter()</A>
<A HREF="ng2f7b.html">cmFiltCount()</A>
<A HREF="ng6d03.html">cmSetLinear()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
