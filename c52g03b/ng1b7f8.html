<HTML>
<HEAD><TITLE>CA-Clipper 5.2 . Technical Reference - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng1adc2.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng1763f.html">[^^Up^^]</A>
<A HREF="ng1be36.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>_xvheapresize()</B>
 Resize a segment heap
------------------------------------------------------------------------------
 <B>C Prototype</B>

     <B>#include "vm.api"</B>
     <B>HANDLE _xvheapresize(</B>
     <B>                      HANDLE hSegment,</B>
     <B>                      USHORT uiSize</B>
     <B>                    )</B>

 <B>Arguments</B>

     <B>hSegment</B> is the VM segment handle returned by _xvheapnew().

     <B>uiSize</B> is the new size in bytes.

 <B>Returns</B>

     If successful, _xvheapresize() returns the original VM segment handle;
     otherwise, it returns zero.

 <B>Description</B>

     _xvheapresize() resizes a previously allocated segment heap, shortening
     or lengthening the segment heap to match the specified size.  If you
     shorten the segment heap, bytes at the end of the segment are lost.

     If the resizing is unsuccessful (indicated by a return value of zero),
     the segment heap retains its original size.

     <B>Warning! </B> Do not use _xvheapresize() to resize a segment heap that
     has any allocated memory block locked.  Unlock the memory block first
     using _xvheapunlock().

 <B>Examples</B>

     <B>.</B>  This example resizes a segment heap:

        // CA-Clipper include files
        #include "extend.api"
        #include "vm.api"

        // Prototype
        Boolean HeapResize(HANDLE hSegment, unsigned uiNewSize);


        Boolean HeapResize(HANDLE hSegment, unsigned uiNewSize)
        {
           Boolean bResult = FALSE;

           // Don't attempt to resize locked segment
           //
           if (_xvlockcount(hSegment) == 0)
              {
              if (_xvheapresize(hSegment, uiNewSize))
                 bResult = TRUE;
              }

           return (bResult);
        }

 <B>Files:</B>  Library is CLIPPER.LIB, header file is Vm.api.

</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng1adc2.html">_xvheapnew()</A>
<HR>
This page created by ng2html v1.05, the Norton guide to HTML conversion utility.
Written by <A HREF="http://www.acemake.com/hagbard">Dave Pearson</A>
<HR>
</BODY>
</HTML>
